<Window x:Class="Decibel.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Decibel"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:componentModel="clr-namespace:System.ComponentModel;assembly=WindowsBase" 
        xmlns:converters="clr-namespace:Decibel.Converters"
        mc:Ignorable="d"
        Title="Decibel" 
        Icon="/Assets/Icons/icon.ico"
        Height="480" MinHeight="480" 
        Width="550" MinWidth="530"
        Closing="MainWindow_Closing"
        Background="{StaticResource BrushPrimaryBackground}" Cursor="">

    <Window.Resources>
        <converters:DayOfWeekToBooleanConverter x:Key="DayToBoolConverter"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Menu Grid.Row="0" Padding="3">
            <MenuItem Header="Arquivo">
                <MenuItem Header="Salvar" Click="MenuItemSaveChanges_Click" />
                <Separator/>
                <MenuItem Header="Descartar" Click="MenuItemDiscardChanges_Click"/>
            </MenuItem>

            <MenuItem Header="Ferramentas">
                <MenuItem Header="Minimizar" Click="MenuItemMinimize_Click" />
                <Separator/>
                <MenuItem Header="Encerrar" Click="MenuItemCloseApp_Click" />
            </MenuItem>
        </Menu>

        <Grid Grid.Row="1">

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- Planos -->
                <ColumnDefinition Width="*"/>
                <!-- Agendamentos -->
            </Grid.ColumnDefinitions>

            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <ListBox Grid.Row="0" 
                         x:Name="ListaPlanos"
                         Style="{StaticResource PlansSidebar}" 
                         MinWidth="120"
                         ItemsSource="{Binding AvailablePlans}"
                         SelectedItem="{Binding SelectedPlan, Mode=TwoWay}">

                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Grid Margin="2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" 
                                           Text="{Binding Name}"
                                           Margin="5,0"
                                           FontSize="13"
                                           VerticalAlignment="Center"
                                           TextTrimming="CharacterEllipsis"/>
                                
                                <Button Grid.Column="1"
                                        Content="X"
                                        Width="22" 
                                        Height="22"
                                        Style="{StaticResource DeletePlanButton}"
                                        Click="ButtonRemovePlan_Click"/>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>

                    <ListBox.ItemContainerStyle>
                        <StaticResource ResourceKey="PlanItemStyle"/>
                    </ListBox.ItemContainerStyle>
                </ListBox>

                <Button Grid.Row="1"
                        Content="Novo" 
                        VerticalAlignment="Bottom"
                        Click="ButtonPlanAdd_Click"
                        Style="{StaticResource BaseButtonStyle}"
                        Margin="5"/>
            </Grid>


            <Grid Grid.Column="1" Style="{StaticResource SchedulingPanel}">

                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0">
                    <UniformGrid Rows="1" Columns="7" Margin="0,5">

                        <ToggleButton Content="D" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Sunday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                  Converter={StaticResource DayToBoolConverter}, 
                                                  ConverterParameter={x:Static sys:DayOfWeek.Sunday}, 
                                                  Mode=OneWay}"/>

                        <ToggleButton Content="S" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Monday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                  Converter={StaticResource DayToBoolConverter}, 
                                                  ConverterParameter={x:Static sys:DayOfWeek.Monday}, 
                                                  Mode=OneWay}"/>
                        
                        <ToggleButton Content="T" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Tuesday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                  Converter={StaticResource DayToBoolConverter}, 
                                                  ConverterParameter={x:Static sys:DayOfWeek.Tuesday}, 
                                                  Mode=OneWay}"/>
                        
                        <ToggleButton Content="Q" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Wednesday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                 Converter={StaticResource DayToBoolConverter}, 
                                                 ConverterParameter={x:Static sys:DayOfWeek.Wednesday}, 
                                                 Mode=OneWay}"/>
                        
                        <ToggleButton Content="Q" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Thursday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                 Converter={StaticResource DayToBoolConverter}, 
                                                 ConverterParameter={x:Static sys:DayOfWeek.Thursday}, 
                                                 Mode=OneWay}"/>
                                      
                        
                        <ToggleButton Content="S" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Friday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                 Converter={StaticResource DayToBoolConverter}, 
                                                 ConverterParameter={x:Static sys:DayOfWeek.Friday}, 
                                                 Mode=OneWay}"/>

                        <ToggleButton Content="S" 
                                      Style="{StaticResource DayToggleButton}"
                                      Command="{Binding ToggleDayCommand}"
                                      CommandParameter="{x:Static sys:DayOfWeek.Saturday}"
                                      IsChecked="{Binding SelectedPlan.DayOfWeeks, 
                                                 Converter={StaticResource DayToBoolConverter}, 
                                                 ConverterParameter={x:Static sys:DayOfWeek.Saturday}, 
                                                 Mode=OneWay}"/>
                                      
                    </UniformGrid>
                </Grid>

                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Cursor="Hand">
                    <ItemsControl x:Name="ListaHorarios" ItemsSource="{Binding SelectedPlan.VolumeSchedules}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid Margin="0 5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <TextBox Grid.Column="0"
                                             Margin="5"
                                             Width="40"
                                             TextAlignment="Center"
                                             VerticalAlignment="Center"
                                             Text="{Binding Volume, ValidatesOnDataErrors=True, ValidatesOnExceptions=True}"/>

                                    <TextBlock Grid.Column="1"
                                               Text="%"
                                               TextAlignment="Center"
                                               VerticalAlignment="Center"/>

                                    <Slider Grid.Column="2" 
                                            Minimum="0" 
                                            Maximum="100"  
                                            Margin="5"
                                            VerticalAlignment="Center"
                                            Value="{Binding Volume, Mode=TwoWay}"/>

                                    <TextBox Grid.Column="3" 
                                             Width="30" 
                                             Margin="5" 
                                             HorizontalContentAlignment="Center"
                                             Text="{Binding Hour, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, ValidatesOnExceptions=True}"/>

                                    <TextBlock Grid.Column="4" Text=":" VerticalAlignment="Center"/>

                                    <TextBox Grid.Column="5" 
                                             Width="30" 
                                             Margin="5" 
                                             HorizontalContentAlignment="Center"
                                             Text="{Binding Minute, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True, ValidatesOnExceptions=True}"/>

                                    <Button Grid.Column="6" 
                                            Content="-"
                                            Click="ButtonScheduleRemove_Click"
                                            Style="{StaticResource CancelButtonStyle}"/>
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <Button Grid.Row="2" 
                        Content="+" 
                        Click="ButtonScheduleAdd_Click"
                        Style="{StaticResource BaseButtonStyle}"/>
            </Grid>
        </Grid>
    </Grid>
</Window>
